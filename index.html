<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #f8f8f2;
  background-color: #272822;
}
.highlight .err {
  color: #151515;
  background-color: #ac4142;
}
.highlight .c, .highlight .cd, .highlight .cm, .highlight .c1, .highlight .cs {
  color: #505050;
}
.highlight .cp {
  color: #f4bf75;
}
.highlight .nt {
  color: #f4bf75;
}
.highlight .o, .highlight .ow {
  color: #d0d0d0;
}
.highlight .p, .highlight .pi {
  color: #d0d0d0;
}
.highlight .gi {
  color: #90a959;
}
.highlight .gd {
  color: #ac4142;
}
.highlight .gh {
  color: #6a9fb5;
  background-color: #151515;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #aa759f;
}
.highlight .kc {
  color: #d28445;
}
.highlight .kt {
  color: #d28445;
}
.highlight .kd {
  color: #d28445;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #90a959;
}
.highlight .sr {
  color: #75b5aa;
}
.highlight .si {
  color: #8f5536;
}
.highlight .se {
  color: #8f5536;
}
.highlight .nn {
  color: #f4bf75;
}
.highlight .nc {
  color: #f4bf75;
}
.highlight .no {
  color: #f4bf75;
}
.highlight .na {
  color: #6a9fb5;
}
.highlight .m, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mb, .highlight .mx {
  color: #90a959;
}
.highlight .ss {
  color: #90a959;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='https://api.geofenceapi.org/'>GeofenceAPI.org</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="introduction">Introduction</h1>

<p>Welcome to the GeofenceAPI docs! You can use our API to create, modify, and query Geofences.</p>

<p>Since this is a plain REST/JSON API, you can use GeofenceAPI from any language. You can view code plain curl examples in the dark area to the right, and then use that to write an integration from your programming language.</p>

<h1 id="content-type">Content Type</h1>

<blockquote>
<p>To create properly formed requests, always specify application/json via header:</p>
</blockquote>
<pre class="highlight shell"><code><span class="c"># With shell, you can just pass the correct header with each request</span>
curl -H <span class="s2">"Content-type: application/json"</span>
</code></pre>

<p>Callers should always specify the content type as &ldquo;application/json&rdquo; in all api calls.</p>

<h1 id="authentication">Authentication</h1>

<blockquote>
<p>To create authorized curl requests, specify the AuthToken header:</p>
</blockquote>
<pre class="highlight shell"><code><span class="c"># With shell, you can just pass the correct header with each request</span>
curl -H <span class="s2">"AuthToken: YOURKEYHERE"</span>
</code></pre>

<blockquote>
<p>Make sure to replace <code class="prettyprint">YOURKEYHERE</code> with your API key.</p>
</blockquote>

<p>GeofenceAPI uses API keys to allow access to the API. There are two types of API Keys - public and private. In order to access your keys, log in to our <a href="https://api.geofenceapi.org/ui/login">management console</a> and then click on &ldquo;API Keys&rdquo; from the drop down menu in the top right. </p>

<p><em>Unregistered Users:</em> If you do not yet have an account, simply click the &ldquo;Create Geofence&rdquo; button on the main page. An account is automatically generated.</p>

<p>Private keys allow you to create and modify geofences via the API. Public Keys are used to query geofences via the API.</p>

<p>GeofenceAPI expects for the API key to be included in all API requests to the server in a header that looks like the following:</p>

<p><code class="prettyprint">AuthToken: YOURKEYHERE</code></p>

<aside class="notice">
You must replace <code>YOURKEYHERE</code> with your API key.
</aside>

<h1 id="geofences">Geofences</h1>

<h2 id="overview">Overview</h2>

<p>A Geofence object is comprised of one or many <a href="http://geojson.org/" target="_blank">GeoJSON</a> polygons.</p>

<p>The workflow for creating a geofence is as follows:</p>

<ol>
<li>Create the initial geofence</li>
<li>Add GeoJSON polygons</li>
<li>Compile the geofence</li>
<li>Send queries to GeofenceAPI</li>
</ol>

<h2 id="create-a-geofence">Create a Geofence</h2>
<pre class="highlight shell"><code>curl 
  -XPOST 
  -H <span class="s2">"Content-type: application/json"</span>
  -H <span class="s2">"AuthToken: YOURPRIVATEKEYHERE"</span>
  -d <span class="s1">'{"name": "My new geofence"}'</span>
  <span class="s1">'https://api.geofenceapi.org/v1/geofence'</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"91047298638649434"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My new geofence"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Callers shoud HTTP POST a JSON document containing a name key.</p>

<h2 id="update-a-geofence">Update a Geofence</h2>
<pre class="highlight shell"><code>curl 
  -XPUT 
  -H <span class="s2">"Content-type: application/json"</span>
  -H <span class="s2">"AuthToken: YOURPRIVATEKEYHERE"</span>
  -d <span class="s1">'{
  "name": "My updated name"
}'</span> 
 <span class="s1">'https://api.geofenceapi.org/v1/geofence/91047298638649434'</span>
</code></pre>

<p>This endpoint updates an existing Geofence.</p>

<p>The format used is:</p>

<p><code class="prettyprint">PUT https://api.geofenceapi.org/v1/geofence/&lt;ID&gt;</code></p>

<h3 id="url-parameters">URL Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ID</td>
<td>The ID of the geofence to update</td>
</tr>
</tbody></table>

<h3 id="json-parameters">JSON Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>The updated name</td>
</tr>
</tbody></table>

<h2 id="get-a-specific-geofence">Get a Specific Geofence</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://api.geofenceapi.org/v1/geofence/91047298638649434"</span>
  -H <span class="s2">"Content-type: application/json"</span>
  -H <span class="s2">"AuthToken: YOURPRIVATEKEYHERE"</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"91047298638649434"</span><span class="p">,</span><span class="w"> 
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Default"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"bounding_box"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="mf">-122.55523681640625</span><span class="p">,</span><span class="w"> 
    </span><span class="mf">37.640334898059486</span><span class="p">,</span><span class="w"> 
    </span><span class="mf">-122.33276367187499</span><span class="p">,</span><span class="w"> 
    </span><span class="mf">37.80761398306056</span><span class="w">
  </span><span class="p">],</span><span class="w"> 
  </span><span class="nt">"compilation_failed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"> 
  </span><span class="nt">"compilation_state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fresh"</span><span class="p">,</span><span class="w"> 
  </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-09-02 01:30:01.176188-07:00"</span><span class="p">,</span><span class="w"> 
  </span><span class="nt">"geojson_items"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"91290730848360488"</span><span class="p">,</span><span class="w"> 
      </span><span class="nt">"level"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> 
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My First Geofence"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-09-02 17:14:39.663457-07:00"</span><span class="p">,</span><span class="w"> 
      </span><span class="nt">"geojson"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"features"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nt">"geometry"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="nt">"coordinates"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                  </span><span class="p">[</span><span class="w">
                    </span><span class="p">[</span><span class="w">
                        </span><span class="mf">-122.55523681640625</span><span class="p">,</span><span class="w"> 
                        </span><span class="mf">37.640334898059486</span><span class="w">
                    </span><span class="p">],</span><span class="w"> 
                    </span><span class="p">[</span><span class="w">
                        </span><span class="mf">-122.55523681640625</span><span class="p">,</span><span class="w"> 
                        </span><span class="mf">37.80761398306056</span><span class="w">
                    </span><span class="p">],</span><span class="w"> 
                    </span><span class="p">[</span><span class="w">
                        </span><span class="mf">-122.33276367187499</span><span class="p">,</span><span class="w"> 
                        </span><span class="mf">37.80761398306056</span><span class="w">
                    </span><span class="p">],</span><span class="w"> 
                    </span><span class="p">[</span><span class="w">
                        </span><span class="mf">-122.33276367187499</span><span class="p">,</span><span class="w"> 
                        </span><span class="mf">37.640334898059486</span><span class="w">
                    </span><span class="p">],</span><span class="w"> 
                    </span><span class="p">[</span><span class="w">
                        </span><span class="mf">-122.55523681640625</span><span class="p">,</span><span class="w"> 
                        </span><span class="mf">37.640334898059486</span><span class="w">
                    </span><span class="p">]</span><span class="w">
                </span><span class="p">]</span><span class="w">
              </span><span class="p">],</span><span class="w"> 
              </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Polygon"</span><span class="w">
            </span><span class="p">},</span><span class="w"> 
            </span><span class="nt">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nt">"hello"</span><span class="p">:</span><span class="w"> </span><span class="s2">"world"</span><span class="w">
            </span><span class="p">},</span><span class="w"> 
            </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Feature"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w"> 
        </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FeatureCollection"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>This endpoint retrieves a specific geofence.</p>

<h2 id="delete-a-geofence">Delete a Geofence</h2>
<pre class="highlight shell"><code>curl 
  -XDELETE 
  -H <span class="s2">"Content-type: application/json"</span>
  -H <span class="s2">"AuthToken: YOURPRIVATEKEYHERE"</span>
 <span class="s1">'https://api.geofenceapi.org/v1/geofence/91290730848360488'</span>
</code></pre>

<p>This endpoint deletes an existing geofence and all of it&rsquo;s GeoJSON items.</p>

<p>The format used is:</p>

<p><code class="prettyprint">DELETE https://api.geofenceapi.org/v1/geofence/&lt;ID&gt;</code></p>

<h3 id="url-parameters">URL Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ID</td>
<td>The ID of the geofence to delete</td>
</tr>
</tbody></table>

<h2 id="compile-a-geofence">Compile a Geofence</h2>
<pre class="highlight shell"><code>curl 
  -XPOST 
  -H <span class="s2">"Content-type: application/json"</span>
  -H <span class="s2">"AuthToken: YOURPRIVATEKEYHERE"</span>
  -d <span class="s1">'{"geofence_id": "91047298638649434"}'</span>
  <span class="s1">'https://api.geofenceapi.org/v1/geofence/recompilerequest'</span>
</code></pre>

<p>The &ldquo;compile&rdquo; action examines each of the GeoJSON items attached to a Geofence, computes the areas of intersection, applies the merge strategy for the GeoJSON properties, and saves the results into a highly efficient format used for runtime queries. You must invoke the compilation command in order for geofence changes to be applied.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST https://api.geofenceapi.org/v1/geofence/recompilerequest</code></p>

<h3 id="json-parameters">JSON Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>geofence_id</td>
<td>The ID of the geofence to compile</td>
</tr>
</tbody></table>

<h1 id="geojson-items">GeoJSON Items</h1>

<h2 id="add-a-geojson-item">Add a GeoJSON Item</h2>
<pre class="highlight shell"><code>curl 
  -XPOST 
  -H <span class="s2">"Content-type: application/json"</span>
  -H <span class="s2">"AuthToken: YOURPRIVATEKEYHERE"</span>
  -d <span class="s1">'{
  "geofence_id": "91047298638649434",
  "name": "My test GeoJSON item",
  "geojson": {
    "type": "FeatureCollection",
    "features": [
      {
        "geometry": {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -122.4540826678276,
                37.77195292544332
              ],
              [
                -122.45389759540556,
                37.77103912851925
              ],
              [
                -122.44077891111374,
                37.77274374289986
              ],
              [
                -122.44095057249069,
                37.773608756061776
              ],
              [
                -122.4540826678276,
                37.77195292544332
              ]
            ]
          ]
        },
        "type": "Feature",
        "properties": {
          "foo": "bar"
        }
      }
    ]
  }
}'</span> 
 <span class="s1">'https://api.geofenceapi.org/v1/geojsonitem'</span>
</code></pre>

<p>This endpoint adds a new GeoJSON document on to the Geofence.</p>

<p>When adding a new GeoJSON document, you specify the geofence ID, the level that the polygon should be bound to, and a name for reference.</p>

<p><em>level</em> refers to the z-index level that the polygon is attached to. This becomes useful when more than one polygon&rsquo;s area overlaps the same place. GeofenceAPI will merge the properties together of intersection polygons according to their level with properties on higher levels superceeding those on lower levels.</p>

<h2 id="update-a-geojson-item">Update a GeoJSON Item</h2>
<pre class="highlight shell"><code>curl 
  -XPUT 
  -H <span class="s2">"Content-type: application/json"</span>
  -H <span class="s2">"AuthToken: YOURPRIVATEKEYHERE"</span>
  -d <span class="s1">'{
  "name": "The GeoJSON item",
  "level": 1,
  "geojson": {
    "type": "FeatureCollection",
    "features": [
      {
        "geometry": {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -122.4540826678276,
                37.77195292544332
              ],
              [
                -122.45389759540556,
                37.77103912851925
              ],
              [
                -122.44077891111374,
                37.77274374289986
              ],
              [
                -122.44095057249069,
                37.773608756061776
              ],
              [
                -122.4540826678276,
                37.77195292544332
              ]
            ]
          ]
        },
        "type": "Feature",
        "properties": {
          "foo": "bar"
        }
      }
    ]
  }
}'</span> 
 <span class="s1">'https://api.geofenceapi.org/v1/geojsonitem/91290730848360488'</span>
</code></pre>

<p>This endpoint updates an existing GeoJSON item.</p>

<p>The format used is:</p>

<p><code class="prettyprint">PUT https://api.geofenceapi.org/v1/geojsonitem/&lt;ID&gt;</code></p>

<h3 id="url-parameters">URL Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ID</td>
<td>The ID of the geojsonitem to update</td>
</tr>
</tbody></table>

<h3 id="json-parameters">JSON Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>The updated name</td>
</tr>
<tr>
<td>level</td>
<td>The updated level integer</td>
</tr>
<tr>
<td>geojson</td>
<td>The updated geojson</td>
</tr>
</tbody></table>

<h2 id="delete-a-geojson-item">Delete a GeoJSON Item</h2>
<pre class="highlight shell"><code>curl 
  -XDELETE 
  -H <span class="s2">"Content-type: application/json"</span>
  -H <span class="s2">"AuthToken: YOURPRIVATEKEYHERE"</span>
 <span class="s1">'https://api.geofenceapi.org/v1/geojsonitem/91290730848360488'</span>
</code></pre>

<p>This endpoint deletes an existing GeoJSON item.</p>

<p>The format used is:</p>

<p><code class="prettyprint">DELETE https://api.geofenceapi.org/v1/geojsonitem/&lt;ID&gt;</code></p>

<h3 id="url-parameters">URL Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ID</td>
<td>The ID of the geojsonitem to update</td>
</tr>
</tbody></table>

<h1 id="queries">Queries</h1>

<blockquote>
<p>To create authorized curl requests, specify the AuthToken header:</p>
</blockquote>
<pre class="highlight shell"><code><span class="c"># With shell, you can just pass the correct header with each request</span>
curl 
-H <span class="s2">"AuthToken: YOURPRIVATEKEYHERE"</span> 
-H <span class="s2">"Content-type: application/json"</span> 
 <span class="s2">"https://api.geofenceapi.org/v1/query/"</span><span class="se">\</span>
 <span class="s2">"91047298638649434?lat=41.37955647644566"</span><span class="se">\</span>
 <span class="s2">"&amp;lng=-69.73571777347887"</span>
</code></pre>

<blockquote>
<p>Make sure to replace <code class="prettyprint">YOURPRIVATEKEYHERE</code> with your private API key and to replace the geofence id with one that&rsquo;s your own. The server will respond with soemthing like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"payload"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"localteam"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Red Sox"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>When the query point intersects one of the polygons, a 200 HTTP response code is returned with a JSON document containing a payload key. The payload value is the result of merging all of the GeoJSON properties together that intersected the query point.</p>

<aside class="notice">
When the lat/lng query point does not intersect any polygon, a 404 HTTP response code is returned.
</aside>

          <h1 id="errors">Errors</h1>

<p>GeofenceAPI uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>The request was successful</td>
</tr>
<tr>
<td>201</td>
<td>Item successfully created</td>
</tr>
<tr>
<td>400</td>
<td>Bad/Invalid Request</td>
</tr>
<tr>
<td>404</td>
<td>Not Found</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
          </div>
      </div>
    </div>
  </body>
</html>
